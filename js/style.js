var wrap = document.getElementById('wrap');var text = document.getElementById('text');var stat = document.getElementById('stat');var title = document.getElementById('title');var btn_popup = document.getElementById('btn_popup');var popup = document.getElementById('popup');var close = document.getElementById('close');var items = document.getElementById('items');var seri = document.getElementById('seri');var scroll_status = document.getElementById('scroll_status');var temp = 0,sp,ep,onMouseDown = false,curTop = 0,itv1,curPos; // for scrollingvar _index=0,itv; //for sequensevar imgList = new Array();var timing = 200;var inRange = new Array();var maxTop;window.onload = function(){	document.body.addEventListener('touchstart',function(){this.addEventListener('touchmove',function(e){e.preventDefault();},false)},false)		loadImg();	setDefault();	Main();	document.getElementById("close12").addEventListener('click',Close,false);	document.getElementById("open").addEventListener('click',Open,false);	var time_start,time_end;	for(var i = 0; i < stat.children.length;i++){		(function(index){			stat.children[index].addEventListener('mousedown',function(){				clearInterval(itv);				stat.children[temp].classList.remove('act');				title.children[temp].classList.remove('act');				temp = index;				stat.children[temp].classList.add('act');				title.children[temp].classList.add('act');				if(index==0){					inRange[0] = 0;					inRange[1] = 5;					_index = inRange[0];					setTimeout(function(){						itv = setInterval(change,timing);					},10)				}				if(index==1){					inRange[0] = 6;					inRange[1] = 36;					_index = inRange[0];					setTimeout(function(){						itv = setInterval(change,timing);					},10)				}				if(index==2){					inRange[0] = 37;					inRange[1] = 57;					_index = inRange[0];					setTimeout(function(){						itv = setInterval(change,timing);					},10)				}			},false)		})(i)	}		btn_popup.addEventListener('mousedown',function(){		fadeIn(popup,30);	},false)	close.addEventListener('mousedown',function(){		fadeOut(popup,30);	},false)		if(navigator.platform=='iPad'){		items.addEventListener('touchstart',function(e){			e.preventDefault();			clearInterval(itv1);			sp = e.touches[0].clientY;			ep = e.touches[0].clientY;			onMouseDown = true;						/*check time*/			time_start = new Date().getMilliseconds();			/*check time*/						},false);		items.addEventListener('touchmove',function(e){			e.preventDefault();			maxTop = this.offsetHeight-this.parentNode.offsetHeight;			if(onMouseDown==true){				ep = e.touches[0].clientY;								if(this.offsetTop>=-(this.offsetHeight-this.parentNode.offsetHeight)&&this.offsetTop<=0){					scrolling();				}				if(this.offsetTop<-(this.offsetHeight-this.parentNode.offsetHeight)){					this.style.top = -(this.offsetHeight-this.parentNode.offsetHeight) + 'px';					clearInterval(itv1);					return;				}				if(this.offsetTop>0){					this.style.top = 0 + 'px';					clearInterval(itv1);					return;				}							}		},false);		items.addEventListener('touchend',function(){					onMouseDown = false;			curTop = items.offsetTop;						/*check time*/			var timeup = new Date().getMilliseconds();			time_end = timeup;			if(time_end<time_start){				time_end = time_end + 1000;			}			if(time_end-time_start<1000){				var v = Math.abs(ep-sp)/(time_end-time_start);				var square_move = Math.floor(v.toFixed(2)*500);			}			if(ep==sp){				return;			}			if(ep>sp){										curTop = items.offsetTop + square_move;				itv1 = setInterval(function(){					text.innerHTML = items.style.top					if(parseInt(items.style.top)>=0){						items.style.top = 0 +'px';						clearInterval(itv1);						return;					}					sp = 0;					square_move = (square_move - (square_move/50)).toFixed(2);					ep = sp-square_move;					scrolling();					if(square_move<=1){						square_move = 1;						clearInterval(itv1);					}				},10)			}			if(ep<sp){										curTop = items.offsetTop - square_move;				itv1 = setInterval(function(){					if(parseInt(items.style.top)<=-(maxTop)){						items.style.top = -(maxTop) +'px';						clearInterval(itv1);						return;					}					sp = 0;					square_move = (square_move - (square_move/50)).toFixed(2);					ep = square_move;					scrolling();					if(square_move<=1){						square_move = 1;						clearInterval(itv1);					}				},20)			}			/*check time*/					},false);	}	else{		items.addEventListener('mousedown',function(e){			e.preventDefault();			clearInterval(itv1);			sp = e.clientY;			ep = e.clientY;			onMouseDown = true;						/*check time*/			time_start = new Date().getMilliseconds();			/*check time*/						},false)				items.addEventListener('mousemove',function(e){			e.preventDefault();			maxTop = this.offsetHeight-this.parentNode.offsetHeight;			if(onMouseDown==true){				ep = e.clientY;				if(this.offsetTop>=-(this.offsetHeight-this.parentNode.offsetHeight)&&this.offsetTop<=0){					scrolling();				}				if(this.offsetTop<-(maxTop)){					this.style.top = -(maxTop) + 'px';					clearInterval(itv1);					return;				}				if(this.offsetTop>0){					this.style.top = 0 + 'px';					clearInterval(itv1);					return;				}							}		},false)				items.addEventListener('mouseup',function(){					onMouseDown = false;			curTop = items.offsetTop;						/*check time*/						var timeup = new Date().getMilliseconds();			time_end = timeup;			if(time_end<time_start){				time_end = time_end + 1000;			}			if(time_end-time_start<1000){				var v = Math.abs(ep-sp)/(time_end-time_start);				var square_move = Math.floor(v.toFixed(2)*400);			}			if(ep==sp){				return;			}			if(ep>sp){												curTop = items.offsetTop + square_move;								itv1 = setInterval(function(){					if(parseInt(items.style.top)>=0){						items.style.top = 0 +'px';						clearInterval(itv1);						return;					}					sp = 0;					square_move = (square_move - (square_move/50)).toFixed(2);					ep = sp-square_move;					scrolling();					if(square_move<=1){						square_move = 1;						clearInterval(itv1);						return;					}				},10)			}			if(ep<sp){								curTop = items.offsetTop - square_move;				itv1 = setInterval(function(){					if(parseInt(items.style.top)<=-(maxTop)){						items.style.top = -(maxTop) +'px';						clearInterval(itv1);						return;					}					sp = 0;					square_move = (square_move - (square_move/30)).toFixed(2);					ep = square_move;					scrolling();					if(square_move<=1){						square_move = 1;						clearInterval(itv1);						return;					}				},20)			}			/*check time*/					},false);		items.addEventListener('mouseout',function(){onMouseDown = false;curTop = items.offsetTop;},false);	}	}function change(){	if(inRange.length<2){		_index++;		if(_index<6){			stat.children[temp].classList.remove('act');			stat.children[0].classList.add('act');			title.children[temp].classList.remove('act');			title.children[0].classList.add('act');			temp=0;		}		if(_index>36){			stat.children[temp].classList.remove('act');			stat.children[2].classList.add('act');			title.children[temp].classList.remove('act');			title.children[2].classList.add('act');			temp=2;		}		if(_index>=6&&_index<=36){			stat.children[temp].classList.remove('act');			stat.children[1].classList.add('act');			title.children[temp].classList.remove('act');			title.children[1].classList.add('act');			temp=1;		}		seri.style.background = 'url('+imgList[_index].src+')';				if(_index==imgList.length-1){			_index = 0;			//clearInterval(itv);			//return;		}	}	else{		_index++;		seri.style.background = 'url('+imgList[_index].src+')';		if(_index==inRange[1]){			clearInterval(itv)		}	}}function loadImg(){	for(var i=0;i<57;i++){		imgList[i] = new Image();		imgList[i].src='images/Cervelat_Timelapse/'+(i+1)+'.jpg';		if(i==56){			imgList[i].onload = function(){				setTimeout(function(){itv = setInterval(change,timing)},1000);			}		}			}}function scrolling(){		items.style.top = curTop + (ep-sp) +'px';}function setDefault(){	for(var i=0;i<3;i++){		var newLi = document.createElement('li');		var newLi1 = document.createElement('li');		if(i==0){			newLi.classList.add('act');			newLi1.classList.add('act');		}		stat.appendChild(newLi);		title.appendChild(newLi1);	}	document.getElementById('stat').getElementsByTagName('li')[temp].classList.add('act');	document.getElementById('title').getElementsByTagName('li')[temp].classList.add('act');		seri.style.background = 'url('+imgList[_index].src+')';	seri.style.backgroundRepeat = 'no-repeat';	}function fadeIn(els,time){	els.style.display = 'block';	els.style.opacity = '0';	var i=0;	var itv = setInterval(function(){		i++;		els.style.opacity = i/10;		if(i>=10){			clearInterval(itv);		}	},time)}function fadeOut(els,time){	els.style.display = 'block';	els.style.opacity = '1';	var i=10;	var itv = setInterval(function(){		i--;		els.style.opacity = i/10;		if(i<=0){			clearInterval(itv);			els.style.display = 'none';		}	},time)}